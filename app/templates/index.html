<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sentiment Analyzer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        }
        
        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .text-shadow {
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        .animate-pulse-slow {
            animation: pulse 4s infinite;
        }
        
        .result-card {
            transform: translateY(20px);
            opacity: 0;
            transition: all 0.5s ease-out;
        }
        
        .result-card.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .positive-gradient {
            background: linear-gradient(135deg, #4ade80, #22c55e);
        }
        
        .negative-gradient {
            background: linear-gradient(135deg, #f87171, #ef4444);
        }
        
        .neutral-gradient {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
        }
        
        .btn-hover-effect {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn-hover-effect:before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn-hover-effect:hover:before {
            left: 100%;
        }
        
        .typing-indicator {
            display: none;
        }
        
        .typing-indicator.active {
            display: inline-block;
        }
        
        .dot-pulse {
            position: relative;
            left: -9999px;
            width: 10px;
            height: 10px;
            border-radius: 5px;
            background-color: #9880ff;
            color: #9880ff;
            box-shadow: 9984px 0 0 0 #9880ff, 9999px 0 0 0 #9880ff, 10014px 0 0 0 #9880ff;
            animation: dot-pulse 1.5s infinite linear;
        }
        
        @keyframes dot-pulse {
            0% {
                box-shadow: 9984px 0 0 0 #9880ff, 9999px 0 0 0 #9880ff, 10014px 0 0 0 #9880ff;
            }
            16.667% {
                box-shadow: 9984px -10px 0 0 #9880ff, 9999px 0 0 0 #9880ff, 10014px 0 0 0 #9880ff;
            }
            33.333% {
                box-shadow: 9984px 0 0 0 #9880ff, 9999px -10px 0 0 #9880ff, 10014px 0 0 0 #9880ff;
            }
            50% {
                box-shadow: 9984px 0 0 0 #9880ff, 9999px 0 0 0 #9880ff, 10014px -10px 0 0 #9880ff;
            }
            66.667% {
                box-shadow: 9984px 0 0 0 #9880ff, 9999px -10px 0 0 #9880ff, 10014px 0 0 0 #9880ff;
            }
            83.333% {
                box-shadow: 9984px -10px 0 0 #9880ff, 9999px 0 0 0 #9880ff, 10014px 0 0 0 #9880ff;
            }
            100% {
                box-shadow: 9984px 0 0 0 #9880ff, 9999px 0 0 0 #9880ff, 10014px 0 0 0 #9880ff;
            }
        }

        .error-card {
            background: linear-gradient(135deg, #f87171, #ef4444);
        }
        
        .model-tag {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }
        
        .model-naive-bayes {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }
        
        .model-bilstm {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
        }
    </style>
</head>
<body class="min-h-screen gradient-bg">
    <!-- Background decoration -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
        <div class="absolute -top-40 -right-40 w-80 h-80 bg-yellow-300 rounded-full mix-blend-multiply filter blur-xl opacity-30 animate-pulse-slow"></div>
        <div class="absolute -bottom-40 -left-40 w-80 h-80 bg-red-300 rounded-full mix-blend-multiply filter blur-xl opacity-30 animate-pulse-slow" style="animation-delay: 2s;"></div>
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-60 h-60 bg-blue-300 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-float"></div>
        <!-- Movie film strip decoration -->
        <div class="absolute top-10 left-10 text-yellow-400 opacity-20 text-6xl animate-float">
            <i class="fas fa-film"></i>
        </div>
        <div class="absolute bottom-10 right-10 text-yellow-400 opacity-20 text-4xl animate-float" style="animation-delay: 3s;">
            <i class="fas fa-video"></i>
        </div>
    </div>

    <div class="relative z-10 min-h-screen flex items-center justify-center p-4">
        <div class="w-full max-w-4xl">
            <!-- Header -->
            <div class="text-center mb-12">
                <div class="inline-block p-4 glass-effect rounded-2xl mb-6 animate-float">
                    <i class="fas fa-film text-4xl text-yellow-400"></i>
                </div>
                <h1 class="text-5xl font-bold text-white text-shadow mb-4">
                    ðŸŽ¬ Movie Review Analyzer
                </h1>
                <p class="text-xl text-white/80 text-shadow">
                    AI-powered sentiment analysis for movie reviews â€¢ Positive, Neutral, or Negative classification
                </p>
            </div>

            <!-- Main Card -->
            <div class="glass-effect rounded-3xl p-8 shadow-2xl backdrop-blur-lg">
                <div class="space-y-6">                    
                    <div class="flex justify-end mb-4">
                        <div class="text-right">
                            <label for="modelSelect" class="block text-sm font-medium text-white/80 mb-1">
                                <i class="fas fa-robot mr-1"></i> Choose your model
                            </label>
                            <div class="relative">
                                <select 
                                    id="modelSelect" 
                                    class="p-2.5 text-sm text-gray-800 bg-white/90 border border-white/30 rounded-xl focus:outline-none focus:ring-2 focus:ring-yellow-300/50 focus:border-white backdrop-blur-sm appearance-none cursor-pointer"
                                >
                                    <option value="naive_bayes">Naive Bayes</option>
                                    <option value="bilstm">BiLSTM</option>
                                </select>
                                <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                    <i class="fas fa-chevron-down text-gray-600 text-xs"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Input Section -->
                    <div class="space-y-4">
                        <label for="textInput" class="block text-lg font-medium text-white">
                            <i class="fas fa-star mr-2"></i>
                            Write your movie review
                        </label>
                        <div class="relative">
                            <textarea 
                                id="textInput" 
                                placeholder="Share your thoughts about the movie... Was it a masterpiece, mediocre, or a disappointment?"
                                class="w-full h-56 p-4 text-gray-800 bg-white/90 border border-white/30 rounded-2xl focus:outline-none focus:ring-4 focus:ring-yellow-300/50 focus:border-white transition-all duration-300 resize-none text-lg backdrop-blur-sm"
                                maxlength="1000" autocomplete="off"
                            ></textarea>
                            <div class="absolute bottom-3 right-3 text-sm text-gray-500">
                                <span id="charCount">0</span>/1000
                            </div>
                        </div>
                    </div>

                    <!-- Analyze Button -->
                    <div class="text-center">
                        <button 
                            id="analyzeBtn" 
                            class="bg-gradient-to-r from-yellow-600 to-red-600 hover:from-yellow-700 hover:to-red-700 text-white font-semibold py-4 px-12 rounded-2xl text-lg shadow-xl hover:shadow-2xl transform hover:-translate-y-1 transition-all duration-300 btn-hover-effect disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                            <i class="fas fa-search mr-2"></i>
                            <span id="btnText">Analyze Review</span>
                            <div class="typing-indicator ml-2">
                                <div class="dot-pulse"></div>
                            </div>
                        </button>
                    </div>

                    <!-- Results Section -->
                    <div id="resultSection" class="result-card">
                        <!-- Results will be dynamically inserted here -->
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="text-center mt-8">
                <p class="text-white/60 text-sm">
                    <i class="fas fa-popcorn mr-1"></i>
                    AI-powered movie review sentiment analysis â€¢ Choose between Naive Bayes and BiLSTM models
                </p>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const textInput = document.getElementById('textInput');
        const modelSelect = document.getElementById('modelSelect');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const btnText = document.getElementById('btnText');
        const typingIndicator = document.querySelector('.typing-indicator');
        const resultSection = document.getElementById('resultSection');
        const charCount = document.getElementById('charCount');

        // Flask backend URL - change this if your backend runs on a different port
        const BACKEND_URL = 'http://localhost:5000';

        // Character counter
        textInput.addEventListener('input', function() {
            const count = this.value.length;
            charCount.textContent = count;
            
            // Color change based on character limit
            if (count > 800) {
                charCount.style.color = '#ef4444';
            } else if (count > 600) {
                charCount.style.color = '#f59e0b';
            } else {
                charCount.style.color = '#6b7280';
            }
        });

        // Call Flask backend for sentiment analysis
        async function analyzeSentiment(text, model) {
            try {
                const response = await fetch(`${BACKEND_URL}/predict`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        text: text,
                        model: model
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.error || 'Analysis failed');
                }

                return {
                    sentiment: data.sentiment,
                    score: data.score,
                    isPositive: data.is_positive,
                    isNeutral: data.is_neutral,
                    confidence: data.confidence,
                    rawProbability: data.raw_probability,
                    modelUsed: data.model_used || model
                };

            } catch (error) {
                console.error('Error calling backend:', error);
                throw error;
            }
        }

        // Display error message
        function displayError(error) {
            resultSection.innerHTML = `
                <div class="error-card rounded-2xl p-6 border border-red-300/50">
                    <div class="text-center text-white">
                        <i class="fas fa-exclamation-triangle text-4xl mb-3"></i>
                        <h4 class="text-xl font-bold mb-2">Analysis Failed</h4>
                        <p class="text-sm opacity-90 mb-4">
                            ${error.message || 'Unable to analyze the review. Please try again.'}
                        </p>
                        <div class="text-xs opacity-75">
                            <i class="fas fa-info-circle mr-1"></i>
                            Make sure the Flask backend is running on port 5000
                        </div>
                    </div>
                </div>
            `;
            
            // Show error with animation
            setTimeout(() => {
                resultSection.classList.add('show');
            }, 100);
        }

        // Get model display info
        function getModelInfo(model) {
            switch(model) {
                case 'naive_bayes':
                    return {
                        name: 'Naive Bayes',
                        tag: 'NB',
                        tagClass: 'model-naive-bayes',
                        description: 'Traditional ML'
                    };
                case 'bilstm':
                    return {
                        name: 'BiLSTM',
                        tag: 'LSTM',
                        tagClass: 'model-bilstm',
                        description: 'Deep Learning'
                    };
                default:
                    return {
                        name: 'Unknown',
                        tag: '?',
                        tagClass: 'bg-gray-500',
                        description: 'Unknown Model'
                    };
            }
        }

        // Create result display
        function displayResult(result) {
            const { sentiment, score, confidence, isPositive, isNeutral, rawProbability, modelUsed } = result;
            
            let gradientClass, icon, sentimentText, textColor, recommendation, thresholdText;
            
            if (isPositive) {
                gradientClass = 'positive-gradient';
                icon = 'fas fa-thumbs-up';
                sentimentText = 'Positive Review';
                textColor = 'text-green-800';
                recommendation = 'This movie gets a recommendation!';
                thresholdText = 'â‰¥7.0 = Positive';
            } else if (isNeutral) {
                gradientClass = 'neutral-gradient';
                icon = 'fas fa-balance-scale';
                sentimentText = 'Neutral Review';
                textColor = 'text-yellow-800';
                recommendation = 'This movie is okay - could go either way.';
                thresholdText = '4.0-7.0 = Neutral';
            } else {
                gradientClass = 'negative-gradient';
                icon = 'fas fa-thumbs-down';
                sentimentText = 'Negative Review';
                textColor = 'text-red-800';
                recommendation = 'This movie might not be worth watching.';
                thresholdText = 'â‰¤4.0 = Negative';
            }
            
            const scorePercentage = (score / 10) * 100;
            const scoreFormatted = score.toFixed(1);
            const confidencePercentage = (confidence * 100).toFixed(1);
            const rawProbabilityPercentage = (rawProbability * 100).toFixed(1);
            
            // Determine classification for display
            let classificationText;
            if (isPositive) {
                classificationText = 'Recommend';
            } else if (isNeutral) {
                classificationText = 'Maybe';
            } else {
                classificationText = 'Skip';
            }
            
            // Get model info
            const modelInfo = getModelInfo(modelUsed);
            
            resultSection.innerHTML = `
                <div class="bg-white/10 rounded-2xl p-6 border border-white/20">
                    <div class="text-center mb-6">
                        <h3 class="text-2xl font-semibold text-white mb-2">
                            <i class="fas fa-chart-bar mr-2"></i>
                            Review Analysis Complete
                        </h3>
                        <div class="flex justify-center items-center mt-2">
                            <span class="model-tag ${modelInfo.tagClass} mr-2">${modelInfo.tag}</span>
                            <span class="text-white/70 text-sm">Analyzed with ${modelInfo.name} model</span>
                        </div>
                    </div>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <!-- Sentiment Card -->
                        <div class="${gradientClass} rounded-xl p-6 text-center shadow-lg">
                            <div class="text-white">
                                <i class="${icon} text-4xl mb-3"></i>
                                <h4 class="text-xl font-bold mb-2">${sentimentText}</h4>
                                <p class="text-sm opacity-90">
                                    ${recommendation}
                                </p>
                            </div>
                        </div>
                        
                        <!-- Score Card -->
                        <div class="bg-white/20 rounded-xl p-6 text-center">
                            <div class="text-white">
                                <div class="text-3xl font-bold mb-2">${scoreFormatted}/10</div>
                                <p class="text-sm mb-3">Movie Score</p>
                                <div class="w-full bg-white/20 rounded-full h-3 mb-2">
                                  <div class="h-3 rounded-full ${gradientClass} transition-all duration-1000" style="width: ${scorePercentage}%"></div>
                                </div>
                                <p class="text-xs opacity-80">
                                    ${thresholdText}
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Additional Info -->
                    <div class="mt-6 bg-white/10 rounded-xl p-4">
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 text-white text-sm text-center">
                            <div>
                                <i class="fas fa-brain mr-2 text-yellow-400"></i>
                                <span>Confidence: ${confidencePercentage}%</span>
                            </div>
                            <div>
                                <i class="fas fa-film mr-2 text-yellow-400"></i>
                                <span>Classification: ${classificationText}</span>
                            </div>
                            <div>
                                <i class="fas fa-percentage mr-2 text-blue-400"></i>
                                <span>Raw Score: ${rawProbabilityPercentage}%</span>
                            </div>
                            <div>
                                <i class="fas fa-robot mr-2 text-purple-400"></i>
                                <span>Model: ${modelInfo.name}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Show result with animation
            setTimeout(() => {
                resultSection.classList.add('show');
            }, 100);
        }

        // Analyze button click handler
        analyzeBtn.addEventListener('click', async function() {
            const text = textInput.value.trim();
            const selectedModel = modelSelect.value;
            
            if (!text) {
                // Shake animation for empty input
                textInput.style.transform = 'translateX(-10px)';
                setTimeout(() => textInput.style.transform = 'translateX(10px)', 100);
                setTimeout(() => textInput.style.transform = 'translateX(0)', 200);
                textInput.focus();
                return;
            }
            
            // Disable button and show loading
            analyzeBtn.disabled = true;
            btnText.textContent = 'Analyzing';
            typingIndicator.classList.add('active');
            
            // Hide previous results
            resultSection.classList.remove('show');
            
            try {
                // Call the Flask backend with selected model
                const result = await analyzeSentiment(text, selectedModel);
                displayResult(result);
            } catch (error) {
                console.error('Analysis failed:', error);
                displayError(error);
            } finally {
                // Reset button
                analyzeBtn.disabled = false;
                btnText.textContent = 'Analyze Review';
                typingIndicator.classList.remove('active');
            }
        });

        // Enter key to analyze
        textInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                analyzeBtn.click();
            }
        });

        // Model selection change handler
        modelSelect.addEventListener('change', function() {
            // Hide results when model changes
            resultSection.classList.remove('show');
            
            // Optional: Show a subtle indication that model changed
            const modelInfo = getModelInfo(this.value);
            console.log(`Switched to ${modelInfo.name} model`);
        });

        // Add some sample movie review texts on page load (now including neutral examples)
        const sampleTexts = [
            "This movie was absolutely incredible! The acting was phenomenal and the plot kept me on the edge of my seat. A true masterpiece!",
            "What a complete waste of time. Boring, predictable, and poorly acted. I want my money back.",
            "The movie was decent. Some good moments but nothing spectacular. Worth watching once.",
            "It was an okay film. The story was interesting but the execution could have been better.",
            "Amazing cinematography and brilliant performances. This film will be remembered as one of the greatest of all time!",
            "Terrible movie. The story made no sense and the dialogue was cringe-worthy. Definitely skip this one.",
            "The movie had its ups and downs. Good acting but the pacing was off. Average overall.",
            "Outstanding film with incredible special effects and a touching story. Highly recommend!"
        ];

        // Optional: Add a sample text button
        textInput.addEventListener('focus', function() {
            if (!this.value) {
                this.placeholder = "Try: '" + sampleTexts[Math.floor(Math.random() * sampleTexts.length)] + "'";
            }
        });

        // Test backend connection on page load
        window.addEventListener('load', async function() {
            try {
                const response = await fetch(`${BACKEND_URL}/health`);
                if (response.ok) {
                    const data = await response.json();
                    console.log('Backend health check:', data);
                } else {
                    console.warn('Backend health check failed');
                }
            } catch (error) {
                console.warn('Could not connect to backend:', error);
            }
        });
    </script>
</body>
</html>